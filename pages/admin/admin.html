<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Sample Site</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="//maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
    />
    <style>
      .login-container {
        width: 100%;
        min-width: 350px;
      }

      .form {
        width: 100%;
        max-width: 500px;
      }

      .forms {
        max-width: 510px;
      }

      .gap {
        margin-top: 10px;
      }
      .bigGap {
        margin-top: 30px;
      }
      .info {
        font-size: 15px !important;
      }
      .didDoc {
        white-space: pre;
        font-size: 10px !important;
        background-color: aliceblue;
      }
      .didbutton {
        background-color: crimson;
      }
      .didbutton a {
        color: #000;
      }
    </style>
    <script>
      window.onload = function () {
        displayDid();
      };

      function displayDid() {
        const request = new XMLHttpRequest();

        request.open('GET', '/admin/did');

        request.onreadystatechange = function () {
          if (this.readyState === 4 && this.status === 200) {
            const responseJson = JSON.parse(this.responseText);
            document.getElementById(
              'did'
            ).innerHTML = `DID: did:ethr:${responseJson.did}`;
            document.getElementById(
              'address'
            ).innerHTML = `Ethereum Address: ${responseJson.did}`;
            document.getElementById(
              'balance'
            ).innerHTML = `Balance: ${responseJson.balance}`;
            document.getElementById('document').innerHTML = JSON.stringify(
              responseJson.didDoc,
              null,
              3
            );
            const serviceEndpoints = responseJson.didDoc.service.map(
              (service) => {
                return `<br>Type: ${service.type} URL: ${service.serviceEndpoint}`;
              }
            );
            document.getElementById(
              'service-endpoint'
            ).innerHTML = `Service Enpoints: ${serviceEndpoints.toString()}`;
            ).innerHTML = `Service Enpoints: ${serviceEndpoints.join('')}`;
          }
        };
        request.send();
      }
    </script>
  </head>

  <body>
    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <div class="navbar-header">
          <a class="navbar-brand" href="#">Admin</a>
        </div>
      </div>
    </nav>
    <div class="jumbotron login-container">
      <div class="container-fluid">
        <div class="row">
          <div class="col-xs-12">
            <p>
              Manage DID
            </p>
          </div>
          <div class="col-xs-12 col-md-5">
            <ul class="list-group">
              <li class="list-group-item info" id="did">Loading DID</li>
              <li class="list-group-item info" id="address">Loading Address</li>
              <li class="list-group-item info" id="balance">Loading Balance</li>
              <li class="list-group-item info" id="service-endpoint">
                Loding Service Endpoints
              </li>
            </ul>
            <p class="info">DID Document:</p>
            <p id="document" class="info didDoc">Loading</p>
          </div>
          <div class="col-xs-12 col-lg-6 forms">
            <div class="input-group form">
              <span class="input-group-addon">SN</span>
              <input
                type="text"
                class="form-control"
                placeholder="Service Name"
              />
            </div>
            <div class="input-group gap form">
              <span class="input-group-addon">SU</span>
              <input
                type="text"
                class="form-control"
                placeholder="Service URL"
              />
            </div>
            <button type="button" class="btn btn-default btn-lg gap form">
              <a href="/admin/setServiceEndpoint">
                Set Service Endpoint
              </a>
            </button>
            <button type="button" class="btn btn-default btn-lg bigGap form">
              <a href="/admin/rotateKeys">
                Add New Encryption Key
              </a>
            </button>
            <button
              type="button"
              class="btn btn-default btn-lg bigGap form didbutton"
            >
              <a href="/admin/newDid">
                New DID
              </a>
            </button>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
